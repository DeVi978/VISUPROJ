---
title: "IPL 2008-2019 Dataset Analysis"
author: "Debmalya Biswas"
date: "`r Sys.Date()`"
output:
  pdf_document:
    latex_engine: xelatex
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.align = "center")
```

## Introduction

The Indian Premier League (**IPL**) is a Men's T20 franchise cricket league of India that started in 2008. In 2010, the IPL became the first sporting event in the world to be broadcast live on YouTube. The brand value of the IPL in 2019 was â‚¹47,500 crore (US\$5.9 billion). The IPL is the most-attended cricket league in the world and in 2014 was ranked sixth by average attendance among all sports leagues. In this visualization project, we are gonna perform Exploratory Data Analysis (**EDA**) on IPL 2008-2019 dataset by exploring through various statistical queries that might interest an inquisitive cricket mind.

## Dataset & Variables

**Source**: <https://www.kaggle.com/anuranroy/ipldatasets>

```{r}
D <- read.csv("C:/Users/Hrik/Desktop/VISU/VISUPROJ/IPL/deliveries2.csv")
M <- read.csv("C:/Users/Hrik/Desktop/VISU/VISUPROJ/IPL/matches.csv")
# Season-wise <- S
# Player-wise <- P
# Team-wise <- T
# Venue-wise <- V

library(tidyverse)
D <- D %>% 
  filter(is_super_over == 0)
```

The dataset comprises of 2 csv files:

-   **deliveries2.csv**: This dataset consists of 179078 rows and 22 columns. It contains ball-by-ball delivery-wise statistics of every match played in the period 2008-2019. The variables are as follows:

```{r}
knitr::kable(data.frame(Variable = names(D),
                        Type = c("Numeric (discrete)","Binary","Nominal","Nominal","Numeric (discrete)","Numeric (discrete)","Nominal","Nominal","Nominal","Binary",rep("Numeric (discrete)", 8),rep("Nominal", 4)),
                        Description = c("match id number","1 denotes 1st innings, 2 denotes 2nd innings","name of the batting team","name of the bowling team","over number in a match","ball number in an over","name of the striking batsman in the delivery","name of the non-striking batsman in the delivery","name of the bowler","1 if it is a super over delivery else 0","runs for the batting team due to a wide ball delivery","bye runs","legbye runs","runs due to a no-ball delivery","penalty runs","runs scored by the batsman in the delivery","total extra runs scored in the delivery","total runs scored in the delivery","player dismissed in the delivery","type of dismissal","fielder who contributed in the dismissal","winner of the match")))
```

-   **matches.csv**: This dataset consists of 756 rows and 18 columns. It contains match-wise statistics of every match played in the period 2008-2019. The variables are as follows:

```{r}
knitr::kable(data.frame(Variable = names(M),
                        Type = c("Numeric (discrete)","Numeric (discrete)","Nominal","Ordinal",rep("Nominal",3),"Binary","Nominal","Binary","Nominal","Numeric (discrete)","Numeric (discrete)",rep("Nominal", 5)),
                        Description = c("match id number","IPL season","city hosting the match","date of the match","first team","second team","team winning the toss","toss winning team's decision to field or bat","result type of the match is normal, tie or no result","1 if dls method applied else 0","winner of the match","run difference if won by runs","wicket difference if won by wickets","player of the match","venue where the match is played","1st umpire","2nd umpire","3rd umpire")))
```

\pagebreak

## Data Analysis (DA)

### Player-wise

-   Top 10 Run Scorers in IPL:

```{r P1}
D %>% 
  group_by(batsman) %>% 
  summarize(runs = sum(batsman_runs)) %>% 
  arrange(desc(runs)) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(batsman,runs), y = runs, fill = batsman))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = runs),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Runs", title = "Total Runs Scored by a Player", fill = "Batsman")+
  scale_y_continuous(limits = c(0,5600))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: The "Run-Machine" Virat Kohli tops the list with 5434 runs, followed closely by Suresh Raina with 5415 runs and then Rohit Sharma. 7 of the top 10 run scorers are Indian.

\pagebreak

-   Top 10 Wicket Takers in IPL:

```{r P2}
D %>% 
  filter(dismissal_kind %in% c("caught","bowled","caught and bowled","lbw","stumped","hit wicket")) %>% 
  group_by(bowler) %>% 
  summarize(wickets = n()) %>% 
  arrange(desc(wickets)) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(bowler,wickets), y = wickets, fill = bowler))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = wickets),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Wickets", title = "Total Wickets Taken by a Player", fill = "Bowler")+
  scale_y_continuous(limits = c(0,175))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Lasith Malinga tops the most wicket takers list with 170 wickets, followed by Amit Mishra (156) and Harbhajan Singh (150). Dwayne Bravo and Sunil Narine are the only other Overseas players in this list.

\pagebreak

-   Top 10 Six Hitters in IPL:

```{r P3}
D %>% 
  filter(batsman_runs == 6) %>% 
  group_by(batsman) %>% 
  summarize(sixes = n()) %>% 
  arrange(desc(sixes)) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(batsman, sixes), y = sixes, fill = batsman))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = sixes),size = 2.5, position = position_dodge(width = 0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Sixes", title = "Total Sixes Hit by a Player", fill = "Batsman")+
  scale_y_continuous(limits = c(0,335))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: The "Universe Boss" Chris Gayle tops this list hitting a humongous number of 327 sixes in his IPL career 2008-2019, "not-so-close"-ly followed by AB de Villers (214) and Mahendra Singh Dhoni (207). Other foreign players in this list are David Warner, Shane Watson and Kieron Pollard.

\pagebreak

-   Top 10 Boundary Hitters in IPL:

```{r P4}
D %>% 
  filter(batsman_runs == 4) %>% 
  group_by(batsman) %>% 
  summarize(fours = n()) %>% 
  arrange(desc(fours)) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(batsman, fours), y = fours, fill = batsman))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = fours),size = 2.5, position = position_dodge(width = 0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Fours", title = "Total Boundaries Hit by a Player", fill = "Batsman")+
  scale_y_continuous(limits = c(0,540))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: "Gabbar" Shikhar Dhawan has hit the most boundaries (526) in IPL 2008-2019, followed by Suresh Raina (495) and Gautam Gambhir (492). David Warner and Chris Gayle are the only foreign players in this list.

\pagebreak

-   Top 10 Individual Run Scorers in a Match:

```{r P5}
indv <- D %>% 
  group_by(match_id, batsman) %>% 
  summarize(inning_runs = sum(batsman_runs)) %>% 
  arrange(desc(inning_runs)) %>% 
  head(10)
indv %>% 
  ggplot(aes(x = reorder(as.character(match_id), inning_runs), y = inning_runs, fill = batsman))+
  geom_bar(stat = "identity")+
  scale_x_discrete(labels = rev(indv$batsman))+
  geom_text(aes(label = inning_runs),size = 2.5, position = position_dodge(width = 0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Runs", title = "Total Runs Scored in an Inning by a Player", fill = "Batsman")+
  scale_y_continuous(limits = c(0,180))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Chris Gayle has scored the most runs, a huge 175 in an inning, followed by Brendon McCullum (158) and AB de Villers (133). Rishabh Pant (130), Murli Vijay (127) and Virendra Sehwag (122) are the only Indian players in this list.

\pagebreak

-   Top 5 Players with Most IPL Centuries:

```{r P6}
D %>% 
  group_by(match_id, batsman) %>% 
  summarize(inning_runs = sum(batsman_runs)) %>% 
  arrange(desc(inning_runs)) %>% 
  filter(inning_runs >= 100) %>% 
  group_by(batsman) %>% 
  summarize(centuries = n()) %>%
  arrange(desc(centuries)) %>% 
  head(5) %>% 
  ggplot(aes(x = reorder(batsman, centuries), y = centuries, fill = batsman))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = centuries),size = 4.5, position = position_dodge(width = 0.4), vjust = 0.3, hjust = -0.4)+
  coord_flip()+
  labs(x = "Player", y = "Centuries", title = "Total Number of Centuries Hit by a Player", fill = "Batsman")+
  scale_y_continuous(limits = c(0,7.2))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Chris Gayle has hit a total of 7 IPL(2008-2019) Centuries in this 20 over format league, followed by Virat Kohli (5) being the only Indian player in the list.

\pagebreak

-   Top 10 Players with Most IPL Fifties:

```{r P7}
D %>% 
  group_by(match_id, batsman) %>% 
  summarize(inning_runs = sum(batsman_runs)) %>% 
  arrange(desc(inning_runs)) %>% 
  filter(inning_runs >= 50) %>% 
  group_by(batsman) %>% 
  summarize(fifties = n()) %>%
  arrange(desc(fifties)) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(batsman, fifties), y = fifties, fill = batsman))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = fifties),size = 2.5, position = position_dodge(width = 0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Fifties", title = "Total Number of Fifties Hit by a Player", fill = "Batsman")+
  scale_y_continuous(limits = c(0,50))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: David Warner has been the most consistent player with the most number of fifties (48), followed by Virat Kohli (43) and Suresh Raina (39). 

\pagebreak

-   IPL Players with Most Sixes Hit in a Match:

```{r P8}
six_freqs <- D %>% 
  filter(batsman_runs == 6) %>% 
  group_by(match_id, batsman) %>% 
  summarize(freq = n()) %>% 
  arrange(desc(freq)) %>% 
  head(12)
six_freqs %>%
  ggplot(aes(x = reorder(as.character(match_id), freq), y = freq, fill = batsman))+
  geom_bar(stat = "identity")+
  scale_x_discrete(labels = rev(six_freqs$batsman))+
  geom_text(aes(label = freq), size = 2.5, position = position_dodge(width = 0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Sixes Hit", title = "Total Sixes Hit in a Match", fill = "Batsman")+
  scale_y_continuous(limits = c(0,18))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Not to anyone's surprise, Chris Gayle tops the list of hitting the most number of sixes (17) in a single match, followed by Brendon McCullum (13), Chris Gayle (13) and then Chris Gayle (12). Chris Gayle appears 4 times in this list. Murli Vijay (11) and Shreyas Iyer (10) are the only Indians in the list.

\pagebreak

-   Most Man of The Match Award Winners in IPL:

```{r P9}
M %>% 
  group_by(player_of_match) %>% 
  summarize(most_pom = n()) %>% 
  arrange(desc(most_pom)) %>% 
  head(12) %>% 
  ggplot(aes(x = reorder(player_of_match, most_pom), y = most_pom, fill = player_of_match))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = most_pom),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Awards", title = "Most MoM Winner", fill = "Player")+
  scale_y_continuous(limits = c(0,22))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Chris Gayle has been awarded Man of the Match 21 times, followed by AB de Villers (20) and Rohit Sharma (17).

\pagebreak

- Top 10 "Bowled" (direct dismissal) Wicket Takers in IPL:

```{r P10}
D %>% 
  filter(dismissal_kind == "bowled") %>% 
  group_by(bowler) %>% 
  summarize(wickets = n()) %>% 
  arrange(desc(wickets)) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(bowler,wickets), y = wickets, fill = bowler))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = wickets),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Bowled Wickets", title = "Total Bowled Wickets Taken", fill = "Bowler")+
  scale_y_continuous(limits = c(0,65))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Lasith Malinga has the most number of direct "Bowled" dismissals numbering up to 63 taking a huge lead, followed by Piyush chawla (43).

\pagebreak

- Top 10 Powerplay Bowlers in IPL:

```{r P11}
D %>% 
  filter(over <= 6) %>% 
  group_by(bowler) %>% 
  summarize(wickets = sum(dismissal_kind %in% c("caught","bowled","caught and bowled","lbw","stumped","hit wicket"))) %>% 
  arrange(desc(wickets)) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(bowler,wickets), y = wickets, fill = bowler))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = wickets),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Wickets", title = "Total Powerplay Wickets Taken by a Player", fill = "Bowler")+
  scale_y_continuous(limits = c(0,55))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Zaheer Khan has taken 52 wickets in powerplay overs the most by any bowler, followed by Bhuvaneshwar Kumar (46)
and Umesh Yadav (45). Lasith malinga (37) and Morne Morkel (36) are the only foreign players in this list.

\pagebreak

- Top 10 Death Bowlers in IPL:

```{r P12}
D %>% 
  filter(over >= 15) %>% 
  group_by(bowler) %>% 
  summarize(wickets = sum(dismissal_kind %in% c("caught","bowled","caught and bowled","lbw","stumped","hit wicket"))) %>% 
  arrange(desc(wickets)) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(bowler,wickets), y = wickets, fill = bowler))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = wickets),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Wickets", title = "Total Death Wickets Taken by a Player", fill = "Bowler")+
  scale_y_continuous(limits = c(0,120))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```


- *Comment*: Lasith Malinga tops the list by taking a total of 112 wickets in Death Overs only, followed by Dwayne Bravo (95) and Bhuvaneshwar Kumar (80).

\pagebreak

- Most Runs conceded by a Bowler in a Match:

```{r P13}
concede <- D %>% 
  group_by(match_id, bowler) %>% 
  summarize(runs_conceded = sum(batsman_runs) + sum(wide_runs) + sum(noball_runs)) %>% 
  arrange(desc(runs_conceded)) %>% 
  head(10)
concede %>% 
  ggplot(aes(x = reorder(as.character(match_id), runs_conceded), y = runs_conceded, fill = bowler))+
  geom_bar(stat = "identity")+
  scale_x_discrete(labels = rev(concede$bowler))+
  geom_text(aes(label = runs_conceded),size = 2.5, position = position_dodge(width = 0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Runs", title = "Total Runs conceded by a Bowler in a Match", fill = "Bowler")+
  scale_y_continuous(limits = c(0,75))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: In a single Match, Mujeeb Ur Rahman has conceded the most runs (73), followed by Basil Thampi (71) and Tim Southee (67).

\pagebreak

- Most Dot Balls by a Bowler in IPL:

```{r P14}
D %>% 
  filter(wide_runs == 0 & noball_runs == 0 & batsman_runs == 0) %>%
  group_by(bowler) %>% 
  summarize(dot_balls = n()) %>% 
  arrange(desc(dot_balls)) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(bowler,dot_balls), y = dot_balls, fill = bowler))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = dot_balls),size = 2.5, position = position_dodge(width = 0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Player", y = "Runs", title = "Most Dot Balls by a Bowler overall", fill = "Bowler")+
  scale_y_continuous(limits = c(0,1350))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Harbhajan Singh has delivered 1290 dot balls in total the most by any bowler in IPL, followed by Lasith Malinga (1211) and Bhuvaneshwar Kumar (1175). Dale Steyn (1038) is the only other foreign player in this list.

\pagebreak

- Most No-balls by Bowlers in IPL:

```{r P15}
D %>% 
  filter(noball_runs != 0) %>% 
  group_by(bowler) %>% 
  summarize(noballs = n()) %>% 
  arrange(desc(noballs)) %>% 
  head(12) %>% 
  ggplot(aes(x = reorder(bowler, noballs), y = noballs, fill = bowler))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = noballs),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Runs", title = "Total No-balls by a Bowler", fill = "Bowler")+
  scale_y_continuous(limits = c(0, 23))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Sreesanth has bowled the most no-balls (23), followed by Jasprit Bumrah (22) and Ishant Sharma (21).

\pagebreak

- Player with most Catches in IPL:

```{r P16}
D %>% 
  mutate(fielder = ifelse(dismissal_kind == "caught and bowled", bowler, fielder)) %>% 
  filter(fielder != "" & (dismissal_kind == "caught" | dismissal_kind == "caught and bowled")) %>% 
  group_by(fielder) %>% 
  summarize(catches = n()) %>% 
  arrange(desc(catches)) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(fielder, catches), y = catches, fill = fielder))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = catches),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Number of Catches", title = "Total Catches by a Player", fill = "Player")+
  scale_y_continuous(limits = c(0, 115))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```
 
- *Comment*: Dinesh Karthik has taken the most number of catches (109), followed by Suresh Raina (102) and MS Dhoni (98).

\pagebreak

- Players with most Run Outs in IPL:

```{r P17}
D %>% 
  filter(fielder != "" & dismissal_kind == "run out") %>% 
  group_by(fielder) %>% 
  summarize(runouts = n()) %>% 
  arrange(desc(runouts)) %>% 
  head(12) %>% 
  ggplot(aes(x = reorder(fielder, runouts), y = runouts, fill = fielder))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = runouts),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Number of Run Outs", title = "Total Run Outs by a Player", fill = "Player")+
  scale_y_continuous(limits = c(0, 24))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: The Wicketkeeper MS Dhoni (23) tops the list, followed by two non-wicketkeeping skilled throwers and excellent fielders, Ravindra Jadheja (20) and Virat Kohli (17). 

\pagebreak

- Wicketkeepers with most Stumpings in IPL:

```{r P18}
D %>% 
  filter(fielder != "" & dismissal_kind == "stumped") %>% 
  group_by(fielder) %>% 
  summarize(stumpings = n()) %>% 
  arrange(desc(stumpings)) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(fielder, stumpings), y = stumpings, fill = fielder))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = stumpings),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Number of Stumpings", title = "Total Stumpings by a Wicketkeeper", fill = "Wicketkeeper")+
  scale_y_continuous(limits = c(0, 40))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: MS Dhoni tops the list with most stumpings (38), followed by Robin Uthappa (32) and Dinesh Karthik (29). Adam Gilchrist and QUinton de Kock are the only foreign players in this list.

\pagebreak

### Team-wise

-   Total Wins by Teams in IPL:

```{r T1}
M %>%
  filter(result == 'normal') %>% 
  group_by(winner)%>%
  summarize(total_win = n())%>%
  ggplot(aes(x = reorder(winner, total_win),y = total_win,fill = winner))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = total_win),size = 2.5,position=position_dodge(width=0.7), vjust=0.3, hjust=-0.2)+
  coord_flip()+
  labs(x = "Winning Team", y = "Number of wins", title = "Total Matches Won by a Team", fill = "IPL Team")+
  scale_y_continuous(limits = c(0,115))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"),
        legend.key.size = unit(0.3, "cm"),
        legend.text = element_text(size = 8))
```

- *Comment*: Mumbai Indians is the most successful IPL Team in terms of Wins, followed by Chennai Super Kings and Kolkata Knight Riders.

\pagebreak

-   Total Runs Scored by Teams in IPL:

```{r T2}
D %>% 
  group_by(batting_team) %>% 
  summarize(team_runs = sum(total_runs)) %>% 
  ggplot(aes(x = reorder(batting_team, team_runs), y = team_runs, fill = batting_team))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = team_runs),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Runs", title = "Total Runs Scored by a Team", fill = "IPL Team")+
  scale_y_continuous(limits = c(0, 33000))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"),
        legend.key.size = unit(0.3, "cm"),
        legend.text = element_text(size = 8))
```

- *Comment*: Mumbai Indians has scored the most runs in IPL 208-2019, followed by the "not-so-successful" team Royal Challengers Bangalore and Kings XI Punjab. 

\pagebreak

-   Highest Total by Teams in IPL:

```{r T3}
highest_total <- D %>% 
  group_by(match_id, batting_team) %>% 
  summarize(total = sum(total_runs)) %>% 
  arrange(desc(total)) %>% 
  head(10)
highest_total %>% 
  ggplot(aes(x = reorder(as.character(match_id), total), y = total, fill = batting_team))+
  geom_bar(stat = "identity")+
  scale_x_discrete(labels = rev(highest_total$batting_team))+
  geom_text(aes(label = total),size = 2.5, position = position_dodge(width = 0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Total", title = "Highest Team Totals", fill = "IPL Team")+
  scale_y_continuous(limits = c(0,280))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Royal Challengers Bangalore (RCB) holds the record of the highest team total by any team in an inning.

\pagebreak

- Total Overboundaries by Teams in IPL:

```{r T4}
D %>% 
  filter(batsman_runs == 6) %>% 
  group_by(batting_team) %>% 
  summarize(team_sixers = n()) %>% 
  ggplot(aes(x = reorder(batting_team, team_sixers), y = team_sixers, fill = batting_team))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = team_sixers),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Sixers", title = "Total Sixes Hit by a Team", fill = "IPL Team")+
  scale_y_continuous(limits = c(0, 1250))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"),
        legend.key.size = unit(0.3, "cm"),
        legend.text = element_text(size = 8))
```

- *Comment*: Having the top two six-hitters in the team, Royal Challengers Bangalore has unsurprisingly hit the most number of sixes in IPL 2008-2019.

\pagebreak

- Total Boundaries by Teams in IPL:

```{r T5}
D %>% 
  filter(batsman_runs == 4) %>% 
  group_by(batting_team) %>% 
  summarize(team_fours = n()) %>% 
  ggplot(aes(x = reorder(batting_team, team_fours), y = team_fours, fill = batting_team))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = team_fours),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Fours", title = "Total Fours Hit by a Team", fill = "IPL Team")+
  scale_y_continuous(limits = c(0, 2800))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"),
        legend.key.size = unit(0.3, "cm"),
        legend.text = element_text(size = 8))
```

- *Comment*: Mumbai Indians has hit the most number of fours, followed by Kings XI Punjab and Kolkata Knight Riders.

\pagebreak

- Total Wickets Taken by Teams in IPL:

```{r T6}
D %>% 
  filter(dismissal_kind %in% c("caught","bowled","caught and bowled","lbw","stumped","hit wicket")) %>% 
  group_by(bowling_team) %>% 
  summarize(wickets_taken = n()) %>% 
  ggplot(aes(x = reorder(bowling_team, wickets_taken), y = wickets_taken, fill = bowling_team))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = wickets_taken),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Runs", title = "Total Wickets Taken by a Team", fill = "IPL Team")+
  scale_y_continuous(limits = c(0, 1150))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"),
        legend.key.size = unit(0.3, "cm"),
        legend.text = element_text(size = 8))
```

- *Comment*: Mumbai Indians has taken the most number of wickets, followed by Royal Challengers Bangalore and Chennai Super Kings.

\pagebreak

- Total No-balls by Teams in IPL:

```{r T7}
D %>% 
  filter(noball_runs != 0) %>% 
  group_by(bowling_team) %>% 
  summarize(noballs = n()) %>% 
  ggplot(aes(x = reorder(bowling_team, noballs), y = noballs, fill = bowling_team))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = noballs),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Runs", title = "Total No-balls by a Team", fill = "IPL Team")+
  scale_y_continuous(limits = c(0, 110))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"),
        legend.key.size = unit(0.3, "cm"),
        legend.text = element_text(size = 8))
```

- *Comment*: Mumbai Indians Playes has bowled the most number of no-balls in IPL.

\pagebreak

- Most Extra Runs conceded by Teams in IPL:

```{r T8}
D %>% 
  group_by(bowling_team) %>% 
  summarize(extras = sum(extra_runs)) %>% 
  arrange(desc(extras)) %>% 
  ggplot(aes(x = reorder(bowling_team, extras), y = extras, fill = bowling_team))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = extras),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Extra Runs", title = "Total Extra Runs conceded by a Team", fill = "IPL Team")+
  scale_y_continuous(limits = c(0, 1750))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"),
        legend.key.size = unit(0.3, "cm"),
        legend.text = element_text(size = 8))
```

- *Comment*: Mumbai Indians has conceded the most number of runs, followed by RCB and KXIP.

\pagebreak

- Best Chasing Team in IPL:

```{r T9}
toss <- M %>% 
  mutate(toss_loser = ifelse(team1 == toss_winner, team2, team1), .after = toss_winner)
toss %>% 
  mutate(chasing = ifelse(toss_decision == "field", toss_winner, toss_loser), .before = winner) %>% 
  filter(chasing == winner) %>% 
  group_by(chasing) %>% 
  summarize(chaser = n()) %>%
  ggplot(aes(x = reorder(chasing, chaser), y = chaser, fill = chasing))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = chaser),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Number of Matches", title = "Total Matches Won by Chasing", fill = "IPL Team")+
  scale_y_continuous(limits = c(0, 60))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"),
        legend.key.size = unit(0.3, "cm"),
        legend.text = element_text(size = 8))
```

- *Comment*: Kolkata Knight Riders has successfully chased the most number of matches, followed by MI and RCB.

\pagebreak

- Best Defending Team in IPL:

```{r T10}
toss %>% 
  mutate(defending = ifelse(toss_decision == "bat", toss_winner, toss_loser)) %>% 
  filter(defending == winner) %>% 
  group_by(defending) %>% 
  summarize(defender = n()) %>%
  ggplot(aes(x = reorder(defending, defender), y = defender, fill = defending))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = defender),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Team", y = "Number of Matches", title = "Total Matches Won by Defending", fill = "IPL Team")+
  scale_y_continuous(limits = c(0, 60))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"),
        legend.key.size = unit(0.3, "cm"),
        legend.text = element_text(size = 8))
```

- *Comment*: Mumbai Indians has successfully defended the most number of matches, followed by CSK and KXIP.

\pagebreak

### Season-wise

-   Number of Matches Played Each Season:

```{r S1}
Season <- as.character(sort(unique(M$season)))
M %>% 
  group_by(season) %>%
  summarize(matches_played = n()) %>% 
  ggplot(aes(x = Season, y = matches_played, fill = Season))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = matches_played),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "IPL Season", y = "Number of Matches", title = "Total Matches Played per Season")+
  theme_bw()+
  scale_y_continuous(limits = c(0,80))+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(color = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: The most number of matches were played in IPL-2013, compared to other seasons.

\pagebreak

-   Highest Run Scorer by Season in IPL:

```{r S2}
full_data <- D %>%
  left_join(M, by = c("match_id" ="id"))
full_data %>% 
  group_by(season, batsman) %>% 
  summarize(runs = sum(batsman_runs)) %>% 
  filter(runs == max(runs)) %>% 
  ggplot(aes(x = as.character(season), y = runs, fill = batsman))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = runs),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Season", y = "Runs", title = "Highest Run Scorer", fill = "Batsman")+
  scale_y_continuous(limits = c(0,1000))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Virat Kohli has been the highest run scorer in a single season in IPL-2016 scoring a total of 973 runs.

\pagebreak

-   Highest Wicket Taker by Season in IPL:

```{r S3}
full_data %>% 
  filter(dismissal_kind %in% c("caught","bowled","caught and bowled","lbw","stumped","hit wicket")) %>%
  group_by(season, bowler) %>% 
  summarize(wickets = n()) %>%
  filter(wickets == max(wickets)) %>% 
  ggplot(aes(x = as.character(season), y = wickets, fill = bowler))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = wickets),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Season", y = "Runs", title = "Highest Wicket Taker", fill = "Bowler")+
  scale_y_continuous(limits = c(0,33))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Dwayne Bravo has been the leading wicket taker in a single season in IPL-2013 with 32 wickets.

\pagebreak

-   Most Six Hitters by Season:

```{r S4}
six_hitter <- full_data %>%
  filter(batsman_runs == 6) %>% 
  group_by(season, batsman) %>% 
  summarize(runs = n()) %>% 
  filter(runs == max(runs))
six_hitter %>% 
  ggplot(aes(x = paste(season,batsman), y = runs, fill = batsman))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = runs),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  scale_x_discrete(labels = six_hitter$season)+
  coord_flip()+
  labs(x = "Season", y = "Runs", title = "Most Six Hitter", fill = "Batsman")+
  scale_y_continuous(limits = c(0,60))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: Chris Gayle has been the most six hitter in a single season in IPL-2012 hitting 59 sixes. He is also the leading six hitter of three other seasons IPL-2011, IPL-2013 and IPL-2015.

\pagebreak

-   Most Boundary Hitters by Season:

```{r S5}
four_hitter <- full_data %>%
  filter(batsman_runs == 4) %>% 
  group_by(season, batsman) %>% 
  summarize(runs = n()) %>% 
  filter(runs == max(runs))
four_hitter %>% 
  ggplot(aes(x = paste(season,batsman), y = runs, fill = batsman))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = runs),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  scale_x_discrete(labels = four_hitter$season)+
  coord_flip()+
  labs(x = "Season", y = "Runs", title = "Most Boundary Hitter", fill = "Batsman")+
  scale_y_continuous(limits = c(0,90))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: David Warner has been the most boundary hitter in a single season in IPL-2016, closely followed by Sachin Tendulkar in IPL-2010.

\pagebreak

-   Total Sixes Hit, by Season:

```{r S6}
full_data %>%
  filter(batsman_runs == 6) %>% 
  group_by(season) %>% 
  summarize(sixes_hit = n()) %>% 
  ggplot(aes(x = Season, y = sixes_hit, fill = Season))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = sixes_hit),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Season", y = "Overboundaries", title = "Total Sixes Hit", fill = "Season")+
  scale_y_continuous(limits = c(0,900))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: IPL-2018 has seen the most number of overboundaries amounting to 869.

\pagebreak

-   Total Boundaries Hit, by Season:

```{r S7}
full_data %>%
  filter(batsman_runs == 4) %>% 
  group_by(season) %>% 
  summarize(fours_hit = n()) %>% 
  ggplot(aes(x = Season, y = fours_hit, fill = Season))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = fours_hit),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Season", y = "Boundaries", title = "Total Fours Hit", fill = "Season")+
  scale_y_continuous(limits = c(0,2100))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: IPL-2013 has seen the most number of boundaries, a total of 2054.

\pagebreak

### Others

-   Top 10 Venues with most IPL Matches Played:

```{r V1}
M %>% 
  group_by(venue) %>% 
  summarize(total_match = n()) %>%
  arrange(desc(total_match)) %>% 
  head(10) %>% 
  ggplot(aes(x = reorder(venue,total_match),y = total_match))+
  geom_bar(stat = "identity", fill = "#CCFF00")+
  geom_text(aes(label = total_match),size = 2.5,position=position_dodge(width=0.7), vjust=0.3, hjust=1.2)+
  coord_flip()+
  labs(x = "Venue", y = "Number of Matches", title = "Total Matches played in a Venue")+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"))
```

- *Comment*: Highest number of matches were played in Eden Gardens Cricket Stadium in Kolkata, followed by Wankhede Stadium in Mumbai and M Chinnaswamy Stadium in Bangalore.

\pagebreak

- Top 10 Umpires who officiated most number of Matches on-field:

```{r U1}
data.frame(umpire = union_all(M$umpire1, M$umpire2)) %>% 
  group_by(umpire) %>% 
  summarize(umpiring = n()) %>%
  arrange(desc(umpiring)) %>% 
  head(11) %>% 
  ggplot(aes(x = reorder(umpire, umpiring), y = umpiring, fill = umpire))+
  geom_bar(stat = "identity")+
  geom_text(aes(label = umpiring),size = 2.5, position = position_dodge(width=0.7), vjust = 0.3, hjust = -0.2)+
  coord_flip()+
  labs(x = "Umpire", y = "Number of Matches", title = "Total Matches officiated on-field", fill = "Umpire")+
  scale_y_continuous(limits = c(0,110))+
  theme_bw()+
  theme(plot.title = element_text(face = "italic", size = 12),
        plot.background = element_rect(colour = "black"),
        legend.background = element_rect(colour = "black", fill = "#FFFFCC"),
        panel.background = element_rect(fill = "#FFFFCC"))
```

- *Comment*: S Ravi has officiated the most number of 106 IPL matches, followed by Dharmasena (87) and Shamsuddin (73).

\pagebreak

## Conclusion

We have successfully performed an EDA by exploring thorugh various general, batting and bowling queries grouping them by player, team, season and others, and answering them in a visual way for ease of capturing the data analysis and statistics. 